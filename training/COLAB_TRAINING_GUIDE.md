# Training Model in Google Colab

This guide will help you train the TensorFlow Lite model for VocaBoost using Google Colab with Google Drive integration.

## Why Google Colab?

- âœ… **Free GPU access** - Faster training
- âœ… **Pre-installed libraries** - TensorFlow, pandas, etc.
- âœ… **Google Drive integration** - Easy file access
- âœ… **No local setup** - Works in your browser

## Prerequisites

1. **Upload your CSV to Google Drive:**
   - Create a folder named `AAA` in your Google Drive
   - Upload `bisaya_dataset.csv` to that folder
   - The path should be: `My Drive/AAA/bisaya_dataset.csv`

## Step-by-Step Instructions

### Step 1: Open Google Colab

1. Go to [Google Colab](https://colab.research.google.com/)
2. Sign in with your Google account
3. Click **"New notebook"**

### Step 2: Install Required Libraries

In the first cell, run:

```python
!pip install pandas gensim scikit-learn tensorflow
```

This will install all required packages.

### Step 3: Copy Training Script

1. Copy the entire contents of `training/train_tflite_colab.py`
2. Paste into a new Colab cell
3. Run the cell to load the functions

### Step 4: Run the Training

1. Create a new cell
2. Run:
```python
main('AAA')
```

   **Note:** If your folder has a different name, change `'AAA'` to your folder name.

3. **Authorize Google Drive access:**
   - When prompted, click the link to authorize
   - Copy the authorization code
   - Paste it into the input box
   - Press Enter

4. The script will:
   - Mount your Google Drive
   - Load `bisaya_dataset.csv` from the `AAA` folder
   - Train the model
   - Save all output files to the same `AAA` folder

### Step 5: Access Model Files

After training completes:

1. **Open Google Drive** in a new tab
2. **Navigate to the `AAA` folder**
3. You'll find 3 new files:
   - `bisaya_model.tflite` - The TensorFlow Lite model
   - `bisaya_metadata.json` - Vocabulary and translations
   - `bisaya_similarity.json` - Similarity matrix

### Step 6: Download and Add to Flutter Project

1. **Download the 3 files** from Google Drive:
   - Right-click each file â†’ Download
   - Or select all 3 files â†’ Right-click â†’ Download

2. **Create the models directory** in your Flutter project (if it doesn't exist):
   ```bash
   mkdir -p assets/models
   ```

3. **Copy all 3 files** to `assets/models/`:
   ```bash
   # On Windows (PowerShell)
   Copy-Item bisaya_model.tflite assets/models/
   Copy-Item bisaya_metadata.json assets/models/
   Copy-Item bisaya_similarity.json assets/models/
   
   # On Mac/Linux
   cp bisaya_model.tflite assets/models/
   cp bisaya_metadata.json assets/models/
   cp bisaya_similarity.json assets/models/
   ```

4. **Verify `pubspec.yaml`** includes the assets:
   ```yaml
   flutter:
     assets:
       - assets/
       - assets/models/
   ```

5. **Run Flutter**:
   ```bash
   flutter pub get
   flutter run
   ```

## Using a Different Folder Name

If your Google Drive folder has a different name (not "AAA"):

1. **Update the function call:**
   ```python
   main('YourFolderName')
   ```

2. **Or modify the default in the script:**
   ```python
   def main(folder_name='YourFolderName'):
   ```

## File Structure in Google Drive

Your Google Drive should look like this:

```
My Drive/
â””â”€â”€ AAA/
    â”œâ”€â”€ bisaya_dataset.csv          (input - you upload this)
    â”œâ”€â”€ bisaya_model.tflite         (output - generated by script)
    â”œâ”€â”€ bisaya_metadata.json        (output - generated by script)
    â””â”€â”€ bisaya_similarity.json      (output - generated by script)
```

## Expected Output

When training completes, you should see:

```
============================================================
ðŸš€ Bisaya NLP Model Training for TensorFlow Lite
============================================================

Step 1: Loading dataset...
âœ… Loaded 300 entries from bisaya_dataset.csv

Step 2: Preparing training data...
âœ… Prepared 900 training sentences

Step 3: Training Word2Vec embeddings...
ðŸ”„ Training Word2Vec model on 900 sentences...
âœ… Model training completed!

Step 4: Creating TensorFlow model...
ðŸ”„ Creating TensorFlow embedding model...
âœ… TensorFlow model created

Step 5: Converting to TensorFlow Lite...
ðŸ”„ Converting to TensorFlow Lite...
âœ… TensorFlow Lite model saved: bisaya_model.tflite
ðŸ“¦ File size: 45.23 KB

Step 6: Saving metadata...
âœ… Metadata saved: bisaya_metadata.json

Step 7: Calculating similarity matrix...
ðŸ”„ Calculating similarity matrix...
âœ… Similarity matrix saved: bisaya_similarity.json

ðŸ“¥ Downloading model files...
âœ… Created bisaya_model_files.zip
ðŸ“¥ Downloading zip file...

âœ… All files downloaded!
```

## Troubleshooting

### Issue: "No module named 'google.colab'"

**Solution**: Make sure you're running in Google Colab, not locally. The `google.colab` module is only available in Colab.

### Issue: "File not found" error

**Solution**: 
1. Make sure the folder `AAA` exists in your Google Drive
2. Verify `bisaya_dataset.csv` is inside the `AAA` folder
3. Check the file name is exactly `bisaya_dataset.csv` (case-sensitive)
4. Make sure you authorized Google Drive access when prompted

### Issue: "Drive mount failed"

**Solution**:
1. When prompted for authorization, click the link
2. Sign in with your Google account
3. Click "Allow" to grant permissions
4. Copy the authorization code and paste it into Colab

### Issue: Model files are too large

**Solution**: The model should be ~50-100 KB. If it's larger, check:
- The dataset size (should be 300 entries)
- The embedding dimension (should be 100)

### Issue: Files not appearing in Google Drive

**Solution**:
1. Refresh your Google Drive page
2. Check the `AAA` folder (not the root of Drive)
3. Wait a few seconds - Drive sync can take a moment
4. Check Colab output for any error messages

## Next Steps

After adding the model files to your Flutter project:

1. **Test the model loading**:
   ```dart
   await NLPModelService.instance.loadModel();
   print('Model loaded: ${NLPModelService.instance.isLoaded}');
   ```

2. **Test a translation**:
   ```dart
   final translation = NLPModelService.instance.getTranslation('hello', 'English', 'Bisaya');
   print('Translation: $translation');
   ```

3. **Integrate into your quiz screens** - The model is now ready to use!

## Quick Reference

**Training time**: ~1-2 minutes in Colab  
**Model size**: ~50-100 KB  
**Files generated**: 3 files (`.tflite`, 2 `.json`)  
**Total size**: ~100-200 KB  
**Storage location**: Google Drive folder `AAA`  
**Input file**: `AAA/bisaya_dataset.csv`  
**Output files**: `AAA/bisaya_model.tflite`, `AAA/bisaya_metadata.json`, `AAA/bisaya_similarity.json`

